C51 COMPILER V9.00   SYSTEM                                                                08/02/2018 18:09:58 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE SYSTEM
OBJECT MODULE PLACED IN .\Output\System.obj
COMPILER INVOKED BY: E:\Program Files\keil5\C51\BIN\C51.EXE System\System.c LARGE OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTE
                    -XTEND PRINT(.\Listing\System.lst) TABS(2) OBJECT(.\Output\System.obj)

line level    source

   1          /*****************************************************************
   2          **                   大连理工大学 创新创业学院
   3          **                       物联网应用工坊
   4          **---------------------------------------------------------------
   5          ** 项目名称：   WTZP1.0-BlueBerry
   6          ** 日    期：   2018-07-07
   7          ** 作    者：   王老师
   8          **---------------------------------------------------------------
   9          ** 文 件 名：   System.c
  10          ** 文件说明：   系统功能
  11          *****************************************************************/
  12          
  13          /*---------------------INCLUDES----------------------*/
  14          #include ".\Drivers\Drivers.h"
  15          #include ".\Modules\Modules.h"
  16          #include ".\System\System.h"
  17          #include ".\Board\Board.h"
  18          
  19          /*---------------------VARIABLES---------------------*/
  20          //生长参数变量储存区
  21          uint16 DateLiquidT;uint16 DateCO2;uint16 DatePh;
  22          uint16 DateHumidity;uint16 DateTemp;
  23          int16 DateEc;
  24          uint32 DateLux;
  25          //其他控制参数区
  26          
  27          
  28          /*---------------------FUNCTIONS---------------------*/
  29          
  30          /***********************************************************************
  31          ** 函 数 名： InitSystem()
  32          ** 函数说明： 初始化系统
  33          **---------------------------------------------------------------------
  34          ** 输入参数： 无
  35          ** 返回参数： 无
  36          ***********************************************************************/
  37          void InitSystem(void)
  38          {
  39   1        //传感器初始化区域
  40   1        InitI2C();
  41   1        InitLUX();
  42   1        Init_AD();
  43   1        InitPh();
  44   1        AM2301Start();
  45   1        //串口初始化区域
  46   1        InitUart1();
  47   1        InitUart2();
  48   1        InitUart3();
  49   1        //中断或定时器初始化区域
  50   1        InterruptKeyIsr();
  51   1        //植物生长参数控制初始化
  52   1        EEPROMWrite(0x0100,0x08);//PH=8
  53   1        EEPROMWrite(0x0101,0x08);//低位，EC=1800
  54   1        EEPROMWrite(0x0102,0x07);//高位
C51 COMPILER V9.00   SYSTEM                                                                08/02/2018 18:09:58 PAGE 2   

  55   1        //云平台连接
  56   1        WifiLink();
  57   1      }
  58          /***********************************************************************
  59          ** 函 数 名： Sensor()
  60          ** 函数说明： 传感器数据获取
  61          **---------------------------------------------------------------------
  62          ** 输入参数： 无
  63          ** 返回参数： 无
  64          ***********************************************************************/
  65          void Sensor()
  66          {
  67   1        DS18B20Start();
  68   1        Read_AD5933_Temperature(); 
  69   1        DateEc=(int)EC();
  70   1        DateLiquidT=DS18B20();
  71   1        DateLux=Get_Lux();
  72   1        DateCO2=Get_CO2();
  73   1        DatePh=ph();
  74   1        AM2301();
  75   1        WifidatPack();
  76   1      }
  77          /***********************************************************************
  78          ** 函 数 名： LCDdisplay()
  79          ** 函数说明： 将数据上传至串口屏
  80          **---------------------------------------------------------------------
  81          ** 输入参数： 无
  82          ** 返回参数： 无
  83          ***********************************************************************/
  84          void LCDdisplay()
  85          {
  86   1        LCDSend(1,DateLiquidT);//溶液温度
  87   1        LCDSend(2,DateCO2);//CO2浓度
  88   1        LCDSend(3,DatePh);//PH
  89   1        LCDSend(4,DateHumidity);//空气湿度
  90   1        LCDSend(5,DateTemp);//空气温度
  91   1        LCDSend(6,DateEc);//溶液电导率
  92   1        LCDSend(7,DateLux);//光照
  93   1      }
  94          /***********************************************************************
  95          ** 函 数 名： StartSystem()
  96          ** 函数说明： 运行系统
  97          **---------------------------------------------------------------------
  98          ** 输入参数： 无
  99          ** 返回参数： 无
 100          ***********************************************************************/
 101          void StartSystem(void)
 102          {
 103   1        //存储变量区
 104   1        TEST=0;//LED亮
 105   1        //
 106   1          while(1)
 107   1          {
 108   2            Sensor();
 109   2            LCDdisplay();
 110   2            AsmControl();
 111   2            WifiBeat();
 112   2            TEST = ~TEST;
 113   2            UartSend1_Byte(0x11,1);
 114   2          }
 115   1      
 116   1      }
C51 COMPILER V9.00   SYSTEM                                                                08/02/2018 18:09:58 PAGE 3   



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    320    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     16    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
