/*****************************************************************
**                   大连理工大学 创新创业学院
**                       物联网应用工坊
**---------------------------------------------------------------
** 项目名称：   WTZP1.0-BlueBerry
** 日    期：   2018-07-30
** 作    者：   温武军
**---------------------------------------------------------------
** 文 件 名：   LCD.c
** 文件说明：   串口屏通信
*****************************************************************/
/*---------------------INCLUDES----------------------*/
#include "LCD.h"

/*---------------------VARIABLES---------------------*/
uint8 xdata lcd_buf[64];
char LCDAck[5]="";
char *LCDAckp=LCDAck;


/*---------------------FUNCTIONS---------------------*/
/***********************************************************************
** 函 数 名： LCDSend()
** 函数说明： 发送数据到串口屏
**---------------------------------------------------------------------
** 输入参数： uint8 site,uint32 dat
** 返回参数： 无
***********************************************************************/
void LCDSend(uint8 site,uint32 dat)
{
	 UartSend3(0xEE);
	 UartSend3(0xB1);UartSend3(0x10);
	 UartSend3(0x00);UartSend3(0x00);
	 UartSend3(0x00);UartSend3(site);//控件编号
	 sprintf(lcd_buf,"%.1f",(float)dat);
	 UartSend3_str(lcd_buf);
	 UartSend3(0xFF);UartSend3(0xFC);UartSend3(0xFF);UartSend3(0xFF);
}
/***********************************************************************
** 函 数 名： LCDRec()
** 函数说明： 从串口屏接收数据到单片机
**---------------------------------------------------------------------
** 输入参数： 无
** 返回参数： uint8(操作码)
***********************************************************************/
uint8 LCDRec()
{
	int j=0;
	char k;
  k=UartRec3(LCDAck);
	{
		while(!k)
		{j++;if(j>300)return 0;}//等待无果返回0
		*LCDAckp=k;
	}while(LCDAckp++);
	return 1;//成功返回1
}